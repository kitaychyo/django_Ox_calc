{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Расчет выбросов ТЭС</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h3>Меню</h3>
        </div>
        <ul class="sidebar-menu">
            <li><a href="{% url 'home' %}">Главная</a></li>
            <li><a href="{% url 'NOx' %}">Расчет выбросов оксидов азота (уголь)</a></li>
            <li><a href="{% url 'NOx_fuel' %}">Расчет выбросов оксидов азота (топливо)</a></li>
            <li><a href="{% url 'SOx' %}" class="active">Расчет выбросов оксидов серы</a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="card">
            <h1>Расчет выбросов оксидов серы от котлов ТЭС</h1>

            <!-- Отображение ошибок -->
            {% if form_data.error %}
                <p style="color: red;">{{ form_data.error }}</p>
            {% endif %}

            <form method="POST" action="{% url 'SOx' %}">
                {% csrf_token %}
                <!-- Сохраненные записи -->
                <div class="form-group">
                    <label>Сохраненные записи</label>
                    <select name="calculation_id" class="form-control">
                        <option value="">Выберите запись</option>
                        {% for calc in saved_calculations %}
                            <option value="{{ calc.id }}">{{ calc.name }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" name="load" class="btn">Загрузить сохраненную запись</button>
                </div>

                <!-- Поля формы -->
                <div class="form-container">
                    <div class="form-group">
                        <label>Расход топлива (B, кг/с)</label>
                        <input type="number" min="0" step="0.01" name="B" value="{{ form_data.B|default:0 }}" required>
                    </div>
                    <div class="form-group">
                        <label>Содержание серы (S_r, %)</label>
                        <input type="number" min="0" step="0.01" name="S_r" value="{{ form_data.S_r|default:0 }}" required>
                    </div>
                    <div class="form-group">
                        <label>Доля оксидов серы, связываемых летучей золой (n1_SO2, %)</label>
                        <input type="number" min="0" step="0.01" max = "100" name="n1_SO2" value="{{ form_data.n1_SO2|default:0 }}" required>
                    </div>
                    <div class="form-group">
                        <label>Доля оксидов серы, улавливаемых в золоуловителе (n2_SO2, %)</label>
                        <input type="number" min="0" step="0.01" max = "100" name="n2_SO2" value="{{ form_data.n2_SO2|default:0 }}" required>
                    </div>
                    <div class="form-group">
                        <label>Название расчета</label>
                        <input type="text" name="name" value="{{ form_data.name|default_if_none:'тест' }}">
                    </div>
                </div>

                <!-- Кнопка расчета -->
                <button type="submit" name="calculate" class="btn">Рассчитать выбросы оксида серы</button>
                <button type="submit" name="clear" class="btn">Очистка формы</button>
                <!-- Результаты -->
                {% if form_data.itog %}
                    <div class="results">
                        <h2>Результаты расчёта:</h2>
                        <p>Выбросы оксида серы (г/с): {{ form_data.itog }}</p>
                        <button type="submit" name="save" class="btn">Сохранить</button>
                        <button type="submit" name="download" class="btn">Скачать</button>
                    </div>
                {% endif %}
            </form>
        </div>
    </div>
</body>
</html>